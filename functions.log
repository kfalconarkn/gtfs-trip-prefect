2025-03-04 13:54:55.620 | INFO     | __main__:<module>:191 - Starting GTFS stops etl update
2025-03-04 13:54:55.623 | INFO     | __main__:fetch_gtfs_stops_flow:183 - Starting GTFS stops flow
2025-03-04 13:54:55.624 | INFO     | functions:fetch_and_process_trip_updates:90 - === Starting GTFS data fetch and processing ===
2025-03-04 13:54:55.627 | INFO     | functions:fetch_trip_updates:24 - Fetching trip updates from Translink API...
2025-03-04 13:54:56.117 | INFO     | functions:fetch_trip_updates:29 - Received response from API with status: 200
2025-03-04 13:54:56.129 | INFO     | functions:fetch_and_process_trip_updates:94 - Parsed feed with 1612 entities
2025-03-04 13:55:05.680 | INFO     | functions:fetch_and_process_trip_updates:105 - Processed 281 SBL trips out of 1612 total entities
2025-03-04 13:55:05.680 | INFO     | functions:fetch_and_process_trip_updates:106 - Total stop updates collected: 4894
2025-03-04 13:55:05.680 | INFO     | functions:fetch_and_process_trip_updates:109 - === Transforming data to group stops by trip_id and route_id ===
2025-03-04 13:55:05.682 | INFO     | functions:fetch_and_process_trip_updates:133 - Grouped data into 281 unique trip_id/route_id combinations
2025-03-04 13:55:05.683 | INFO     | functions:fetch_and_process_trip_updates:136 - === Filtering to include only min stop sequence and next one ===
2025-03-04 13:55:05.683 | SUCCESS  | functions:fetch_and_process_trip_updates:160 - === Processing complete: 281 trips with filtered stops ===
2025-03-04 13:55:05.685 | INFO     | __main__:upload_gtfs_stops_to_redis_task:29 - Connecting to Redis...
2025-03-04 13:55:07.268 | INFO     | __main__:upload_gtfs_stops_to_redis_task:49 - Successfully connected to Redis at redis-11529.c323.us-east-1-2.ec2.redns.redis-cloud.com:11529
2025-03-04 13:55:07.502 | INFO     | __main__:upload_gtfs_stops_to_redis_task:50 - Redis server info: 7.4.2
2025-03-04 13:55:07.790 | INFO     | __main__:upload_gtfs_stops_to_redis_task:51 - Current database size: 329 keys
2025-03-04 13:55:07.793 | INFO     | __main__:upload_gtfs_stops_to_redis_task:65 - Processing 281 trips for batch upload...
2025-03-04 13:55:08.287 | INFO     | __main__:upload_gtfs_stops_to_redis_task:87 - Found 3 existing keys that need to be updated
2025-03-04 13:55:08.599 | INFO     | __main__:upload_gtfs_stops_to_redis_task:157 - Executing final batch operations: 3 updates and 278 new entries...
2025-03-04 13:55:09.958 | SUCCESS  | __main__:upload_gtfs_stops_to_redis_task:164 - Successfully processed 281 trips to Redis using batch operations
2025-03-04 13:55:09.960 | INFO     | __main__:upload_gtfs_stops_to_redis_task:165 -   - Updated 3 existing entries
2025-03-04 13:55:09.961 | INFO     | __main__:upload_gtfs_stops_to_redis_task:166 -   - Created 278 new entries
2025-03-04 13:55:09.962 | INFO     | __main__:upload_gtfs_stops_to_redis_task:167 -   - All keys set to expire in 129600 seconds (36 hours)
2025-03-04 13:55:09.963 | INFO     | __main__:upload_gtfs_stops_to_redis_task:168 -   - Total time: 4.27 seconds (65.78 operations/second)
2025-03-04 13:55:09.965 | INFO     | __main__:fetch_gtfs_stops_flow:186 - GTFS stops flow completed
